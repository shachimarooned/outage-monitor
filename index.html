<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Cloud-Service Outage Monitor</title>
<style>
  body{font-family:system-ui,Arial,sans-serif;background:#f6f8fa;margin:0;padding:2rem;line-height:1.4}
  h1{margin-top:0}
  .card{background:#fff;border:1px solid #d0d7de;border-radius:8px;padding:1rem;margin-bottom:1rem;box-shadow:0 1px 3px rgba(0,0,0,.05)}
  .card h2{margin:0 0 .25rem;font-size:1.1rem}
  .card time{color:#61676d;font-size:.85rem}
  .error{color:#d73a49;font-size:.9rem}
</style>
</head>
<body>
<h1>Cloud&nbsp;Outage&nbsp;Monitor</h1>
<div id="feed-container"></div>

<script type="module">
  /* 1 ─ feeds to display ──────────────────────────────────────────────── */
  const feeds = {
    'OpenAI'       : 'https://status.openai.com/feed.rss',
    'AWS'          : 'https://status.aws.amazon.com/rss/health.rss',
    'Azure'        : 'https://rssfeed.status.azure.com/status/feed',
    'Google Cloud' : 'https://status.cloud.google.com/en/feed.atom',
    'Slack'        : 'https://slack-status.com/feed/rss',
    'GitHub'       : 'https://www.githubstatus.com/history.rss',
    'Cloudflare'   : 'https://www.cloudflarestatus.com/history.rss'
  };

  /* 2 ─ simple CORS proxy ─────────────────────────────────────────────── */
  const proxify = url =>
    `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;

  /* 3 ─ helper: extract first item/entry from an RSS or Atom feed ─────── */
  function parseFirstItem(xml) {
    const doc = new DOMParser().parseFromString(xml, 'application/xml');

    /* RSS 2.0 */
    let item = doc.querySelector('channel > item');
    if (item) {
      return {
        title : item.querySelector('title')?.textContent?.trim() ?? '(no title)',
        link  : item.querySelector('link')?.textContent?.trim()  ?? '#',
        date  : item.querySelector('pubDate')?.textContent       ??
                item.querySelector('dc\\:date')?.textContent     ?? ''
      };
    }

    /* Atom 1.0 */
    item = doc.querySelector('feed > entry');
    if (item) {
      const linkElem = item.querySelector('link[rel="alternate"]') ||
                       item.querySelector('link:not([rel])')        ||
                       item.querySelector('link');
      return {
        title : item.querySelector('title')?.textContent?.trim() ?? '(no title)',
        link  : linkElem?.getAttribute('href') ?? '#',
        date  : item.querySelector('updated')?.textContent ??
                item.querySelector('published')?.textContent ?? ''
      };
    }

    throw new Error('Unrecognised feed format');
  }

  /* 4 ─ render cards ──────────────────────────────────────────────────── */
  const container = document.getElementById('feed-container');

  for (const [name, url] of Object.entries(feeds)) {
    const card = document.createElement('section');
    card.className = 'card';
    card.innerHTML = `<h2>${name}</h2><p>Loading…</p>`;
    container.appendChild(card);

    fetch(proxify(url))
      .then(r => r.text())
      .then(xml => {
        const {title, link, date} = parseFirstItem(xml);
        card.innerHTML =
          `<h2>${name}</h2>
           <p><strong>${title}</strong></p>
           <time datetime="${date}">${new Date(date).toLocaleString()}</time><br>
           <a href="${link}" target="_blank" rel="noopener">Full details →</a>`;
      })
      .catch(err => {
        card.innerHTML =
          `<h2>${name}</h2>
           <p class="error">Couldn’t load feed<br><code>${err.message}</code></p>`;
        console.error(`${name}:`, err);
      });
  }
</script>
</body>
</html>
